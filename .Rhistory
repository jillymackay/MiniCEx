dat <- readxl::read_excel("//cmvm.datastore.ed.ac.uk/cmvm/eb/users/jmackay4/Operational/AY 2022-2023/Mini CE/FY Mini CE v1 2022.xlsx")
names(dat)
dat <- readxl::read_excel("//cmvm.datastore.ed.ac.uk/cmvm/eb/users/jmackay4/Operational/AY 2022-2023/Mini CE/FY Mini CE v1 2022.xlsx") %>%
colnames("ID",
"StartTime",
"EndTime",
"Email",
"Name",
"StudentName",
"StudentMatricNumber",
"Assessor",
"SelfComplete",
"Rotation",
"Species",
"ReferralYN",
"MainTask",
"TaskSummary",
"DateEvent",
"Organisation",
"Communication",
"History",
"PhysicalExam",
"ClinicalSkills",
"ClinicalReasoning",
"OverallAssessorFeedback",
"Feedback_forNextTime",
"StudentReflection",
"AssessorEmail",
"StudentCompleted",
"StudentDeclaration")
library(tidyverse)
dat <- readxl::read_excel("//cmvm.datastore.ed.ac.uk/cmvm/eb/users/jmackay4/Operational/AY 2022-2023/Mini CE/FY Mini CE v1 2022.xlsx") %>%
colnames("ID",
"StartTime",
"EndTime",
"Email",
"Name",
"StudentName",
"StudentMatricNumber",
"Assessor",
"SelfComplete",
"Rotation",
"Species",
"ReferralYN",
"MainTask",
"TaskSummary",
"DateEvent",
"Organisation",
"Communication",
"History",
"PhysicalExam",
"ClinicalSkills",
"ClinicalReasoning",
"OverallAssessorFeedback",
"Feedback_forNextTime",
"StudentReflection",
"AssessorEmail",
"StudentCompleted",
"StudentDeclaration")
View(dat)
?col_names
dat <- readxl::read_excel("//cmvm.datastore.ed.ac.uk/cmvm/eb/users/jmackay4/Operational/AY 2022-2023/Mini CE/FY Mini CE v1 2022.xlsx") %>%
colnames(c("ID",
"StartTime",
"EndTime",
"Email",
"Name",
"StudentName",
"StudentMatricNumber",
"Assessor",
"SelfComplete",
"Rotation",
"Species",
"ReferralYN",
"MainTask",
"TaskSummary",
"DateEvent",
"Organisation",
"Communication",
"History",
"PhysicalExam",
"ClinicalSkills",
"ClinicalReasoning",
"OverallAssessorFeedback",
"Feedback_forNextTime",
"StudentReflection",
"AssessorEmail",
"StudentCompleted",
"StudentDeclaration"))
dat <- readxl::read_excel("//cmvm.datastore.ed.ac.uk/cmvm/eb/users/jmackay4/Operational/AY 2022-2023/Mini CE/FY Mini CE v1 2022.xlsx") %>%
rename("ID" = "ID",
"StartTime" = "Start time",
"EndTime" = "Completion time",
"StudentName" = "Student Name",
"StudentMatricNumber" = "Student matriculation number (i.e s1234567)",
"Assessor" = "Assessor name and job role (for email)",
"SelfComplete" = "Is the student completing this form on behalf of the assessor?",
"Rotation" = "Title of rotation week",
"Species" = "Please indicate which species you were working with for this observation",
"ReferralYN" = "Does this feedback observation relate to a referral level procedure? (See guidance notes)",
"MainTask" = "Please indicate the nature of the mini-CEx observation (i.e. what was the main task?)",
"TaskSummary" = "Brief summary of task performed (include case signalment and presenting problem, if\r\nappropriate). 1-2 sentences only required here.",
"DateEvent" = "Date of feedback observation",
"Organisation" = "Organisation: well organised approach to the task; evidence of suitable preparation beforehand",
"Communication" = "Communication: effectively communicates with client/colleagues including appropriate use of language, non-verbal skills and rapport",
"History" = "History Taking (where applicable): methodical approach; relevant information gathered, appropriate recording",
"PhysicalExam" = "Physical Examination of Patient (where applicable): Methodical approach; competent examination performed; relevant data gathered and recorded; considerate patient handling throughout",
"ClinicalSkills" =  "Clinical Skills: task competently performed with/without instruction; good manual dexterity; safe and appropriate handling of equipment" ,
"ClinicalReasoning" = "Clinical Reasoning: Appropriate treatment plan formulated based on information available; rational selection of further diagnostic tests/procedures or next steps",
"OverallAssessorFeedback" = "Assessor feedback on the student's overall professionalism and competence\r\non this occasion",
"Feedback_forNextTime" = "Please provide some general feedback for the student on what they did well and\r\nwhat they should work on for next time" ,
"StudentReflection" = "Student self-reflection on feedback received and next steps",
"StudentDeclaration" = "Student declaration: I confirm that I have checked the contents of this form with my assessor prior to submission and they have approved it"))
dat <- readxl::read_excel("//cmvm.datastore.ed.ac.uk/cmvm/eb/users/jmackay4/Operational/AY 2022-2023/Mini CE/FY Mini CE v1 2022.xlsx") %>%
rename("ID" = "ID",
"StartTime" = "Start time",
"EndTime" = "Completion time",
"StudentName" = "Student Name",
"StudentMatricNumber" = "Student matriculation number (i.e s1234567)",
"Assessor" = "Assessor name and job role (for email)",
"SelfComplete" = "Is the student completing this form on behalf of the assessor?",
"Rotation" = "Title of rotation week",
"Species" = "Please indicate which species you were working with for this observation",
"ReferralYN" = "Does this feedback observation relate to a referral level procedure? (See guidance notes)",
"MainTask" = "Please indicate the nature of the mini-CEx observation (i.e. what was the main task?)",
"TaskSummary" = "Brief summary of task performed (include case signalment and presenting problem, if\r\nappropriate). 1-2 sentences only required here.",
"DateEvent" = "Date of feedback observation",
"Organisation" = "Organisation: well organised approach to the task; evidence of suitable preparation beforehand",
"Communication" = "Communication: effectively communicates with client/colleagues including appropriate use of language, non-verbal skills and rapport",
"History" = "History Taking (where applicable): methodical approach; relevant information gathered, appropriate recording",
"PhysicalExam" = "Physical Examination of Patient (where applicable): Methodical approach; competent examination performed; relevant data gathered and recorded; considerate patient handling throughout",
"ClinicalSkills" =  "Clinical Skills: task competently performed with/without instruction; good manual dexterity; safe and appropriate handling of equipment" ,
"ClinicalReasoning" = "Clinical Reasoning: Appropriate treatment plan formulated based on information available; rational selection of further diagnostic tests/procedures or next steps",
"OverallAssessorFeedback" = "Assessor feedback on the student's overall professionalism and competence\r\non this occasion",
"Feedback_forNextTime" = "Please provide some general feedback for the student on what they did well and\r\nwhat they should work on for next time" ,
"StudentReflection" = "Student self-reflection on feedback received and next steps",
"StudentDeclaration" = "Student declaration: I confirm that I have checked the contents of this form with my assessor prior to submission and they have approved it")
names(dat)
shiny::runApp('app')
runApp('app')
library(shiny)
runApp('app')
shiny::runApp('//cmvm.datastore.ed.ac.uk/cmvm/eb/users/jmackay4/Operational/Shiny Apps/MiniCEx/app')
runApp('//cmvm.datastore.ed.ac.uk/cmvm/eb/users/jmackay4/Operational/Shiny Apps/MiniCEx/app')
runApp('//cmvm.datastore.ed.ac.uk/cmvm/eb/users/jmackay4/Operational/Shiny Apps/MiniCEx/app')
runApp('')
shiny::runApp('app')
dat %>% select(matric) %>% unique()
View(dat)
dat %>% select(StudentMatricNumber) %>% unique()
?tableOutput
runApp('app')
runApp()
runApp('app')
runApp('app')
runApp('app')
runApp('app')
runApp('app')
runApp('app')
?tabyl
runApp('app')
runApp()
runApp('app')
shiny::runApp('app')
fil1 <-("//cmvm.datastore.ed.ac.uk/cmvm/eb/users/jmackay4/Operational/AY 2023-2024/MiniCEx/FY23-24 core rotation timetable for Alex.xlsx")
library(tidyverse)
library(minicexpack)
library(knitr)
library(flextable)
ttable <- readxl::read_excel(fil1, sheet = "2022-2023", range = "A6:AP183") %>%
mutate(name = paste0(`...3`," ", `...4`)) %>%
select(c("...2", "1":"28", name)) %>%
rename(matric = "...2",
"05-06-23" = "1",
"12-06-23" = "2",
"19-06-23" = "3",
"26-06-23" = "4",
"03-07-23" = "...11",
"10-07-23" = "...12",
"17-07-23" = "...13",
"24-07-23" = "...14",
"31-07-23" = "5",
"07-08-23" = "6",
"14-08-23" = "7",
"21-08-23" = "8",
"28-08-23" = "9",
"04-09-23" = "10",
"11-09-23" = "11",
"18-09-23" = "12",
"25-09-23" = "13",
"02-10-23" = "14",
"09-10-23" = "15",
"16-10-23" = "16",
"23-10-23" = "17",
"30-10-23" = "18",
"06-11-23" = "19",
"13-11-23" = "20",
"20-11-23" = "21",
"27-11-23" = "22",
"04-12-23" = "23",
"11-12-23" = "24",
"18-12-23" = "...35",
"25-12-23" = "...36",
"01-01-24" = "...37",
"08-01-24" = "**",
"15-01-24" = "25",
"22-01-24" = "26",
"29-01-24" = "27",
"05-02-24" = "28")  %>%
pivot_longer(cols = -c(matric, name),
names_to = "Week",
values_to = "Rotation") %>%
mutate (WeekN = dmy(Week),
WeekN = lubridate::week(WeekN)) %>%
mutate (Rotation =  zoo::na.locf(Rotation),
matric = tolower(matric))
inglisthisweek <- ttable %>%
filter(WeekN == whatweek,
Rotation == "Inglis Veterinary Practice") %>%
select(matric)
whatweek <- lubridate::week(Sys.Date())
inglisthisweek <- ttable %>%
filter(WeekN == whatweek,
Rotation == "Inglis Veterinary Practice") %>%
select(matric)
View(inglisthisweek)
View(dat)
View(ttable)
ttable %>% select(WeekN = 24)
ttable %>% filter(WeekN == 24)
ttable %>% filter(WeekN == 24) %>%  View()
View(dat)
View(ttable)
ttable %>% filter(Week == "12-06-23") %>%  View()
shiny::runApp('app')
runApp('app')
?req
runApp('app')
